<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension
         point="org.eclipse.ui.commands">
   </extension>
   <extension
         point="org.eclipse.ui.commands">
      <command
            id="org.eclipse.viatra2.patternlanguage.emf.matcherbuilder.ui.selfrun"
            name="Evaluate on self">
      </command>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            allPopups="false"
            locationURI="popup:org.eclipse.jdt.ui.PackageExplorer">
             <menu
                   id="org.eclipse.viatra2.patternlanguage.emf.matcherbuilder.ui.menu.packageExplorer"
                   label="EMF-IncQuery">
            <command
                  commandId="org.eclipse.viatra2.patternlanguage.emf.matcherbuilder.ui.selfrun"
                  style="push">
                              <visibleWhen
                                    checkEnabled="false">
                                 <with
                                       variable="selection">
                                    <iterate
                                          ifEmpty="false">
                                       <adapt
                                             type="org.eclipse.core.resources.IFile">
                                          <test
                                                property="org.eclipse.core.resources.name"
                                                value="*.emfpattern">
                                          </test>
                                       </adapt>
                                    </iterate>
                                 </with>
                              </visibleWhen>
            </command>         
        </menu>
      </menuContribution>
      <menuContribution
            allPopups="false"
            locationURI="popup:org.eclipse.ui.navigator.ProjectExplorer#PopupMenu">
           <menu
                 id="org.eclipse.viatra2.patternlanguage.emf.matcherbuilder.ui.menu.projectExplorer"
                 label="EMF-IncQuery">
            <command
                  commandId="org.eclipse.viatra2.patternlanguage.emf.matcherbuilder.ui.selfrun"
                  style="push">
                               <visibleWhen
                  checkEnabled="false">
                                  <reference
                                        definitionId="org.eclipse.viatra2.patternlanguage.emf.file">
                                  </reference>
            </visibleWhen>
            </command>
           </menu>
      </menuContribution>
      <menuContribution
            allPopups="false"
            locationURI="popup:org.eclipse.ui.views.ResourceNavigator">
        <menu
              id="org.eclipse.viatra2.patternlanguage.emf.matcherbuilder.ui.menu.resourceNavigator"
              label="EMF-IncQuery">
         <command
               commandId="org.eclipse.viatra2.patternlanguage.emf.matcherbuilder.ui.selfrun"
               style="push">                              
               <visibleWhen
                  checkEnabled="false">
                  <reference
                        definitionId="org.eclipse.viatra2.patternlanguage.emf.file">
                  </reference>
            </visibleWhen>
         </command>         
        </menu>
      </menuContribution>
      
   </extension>
   
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            class="org.eclipse.viatra2.patternlanguage.emf.matcherbuilder.ui.handlers.SelfRunHander"
            commandId="org.eclipse.viatra2.patternlanguage.emf.matcherbuilder.ui.selfrun">
      </handler>
   </extension>
   
      <extension
         point="org.eclipse.core.expressions.definitions">
      <definition
            id="org.eclipse.viatra2.patternlanguage.emf.file">
         <with
               variable="selection">
            <iterate
                  ifEmpty="false">
               <adapt
                     type="org.eclipse.core.resources.IFile">
                  <test
                        property="org.eclipse.core.resources.name"
                        value="*.emfpattern">
                  </test>
               </adapt>
            </iterate>
         </with>
      </definition>
   </extension>
   
</plugin>
